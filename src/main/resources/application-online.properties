# ===============================
# Spring Boot PROD (QNAP/Docker)
# ===============================

# --- Server / reverse proxy ---
server.port=${SERVER_PORT:8080}
server.forward-headers-strategy=framework

# (Optioneel) gzip compressie
server.compression.enabled=true
server.compression.mime-types=application/json,application/javascript,text/css,text/html,text/xml,text/plain

# --- Datasource (overridable via env) ---
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:postgresql://db:5432/${POSTGRES_DB:dico}}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:${POSTGRES_USER:dico}}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:${POSTGRES_PASSWORD:change_me}}
spring.datasource.hikari.maximum-pool-size=${DB_POOL_SIZE:10}

# --- JPA / Hibernate ---
spring.jpa.hibernate.ddl-auto=${SPRING_JPA_HIBERNATE_DDL_AUTO:update}
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.jdbc.time_zone=UTC

# --- CORS ---
# Als je een CorsConfigurationSource bean hebt, laat die 'app.cors.allowed-origins' lezen.
# Anders werken onderstaande Spring MVC properties prima als default.
app.cors.allowed-origins=${DICO_ALLOWED_ORIGINS:https://diabetesconnect.info}
spring.mvc.cors.allowed-origins=${DICO_ALLOWED_ORIGINS:https://diabetesconnect.info}
spring.mvc.cors.allowed-methods=GET,POST,PUT,DELETE,PATCH,OPTIONS
spring.mvc.cors.allowed-headers=*
spring.mvc.cors.allow-credentials=true

# --- JWT (eigen configuratie) ---
app.jwt.secret=${DICO_JWT_SECRET:please_change_to_a_long_random_value}
app.jwt.exp-minutes=${DICO_JWT_EXP_MINUTES:120}

# --- Actuator ---
management.endpoints.web.exposure.include=health,info
management.endpoint.health.probes.enabled=true
management.health.livenessstate.enabled=true
management.health.readinessstate.enabled=true

# --- Logging ---
logging.level.org.springframework.web=${SPRING_LOG_LEVEL:INFO}
logging.level.org.hibernate.SQL=${JPA_SQL_LOG:OFF}
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=${JPA_SQL_BIND_LOG:OFF}

# --- Mail (optioneel; via env) ---
spring.mail.host=${SPRING_MAIL_HOST:smtp.gmail.com}
spring.mail.port=${SPRING_MAIL_PORT:587}
spring.mail.username=${SPRING_MAIL_USERNAME:}
spring.mail.password=${SPRING_MAIL_PASSWORD:}
spring.mail.properties.mail.smtp.auth=${SPRING_MAIL_AUTH:true}
spring.mail.properties.mail.smtp.starttls.enable=${SPRING_MAIL_STARTTLS:true}
